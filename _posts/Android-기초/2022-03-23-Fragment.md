---
layout: post
title: "Android: Fragment"
date: 2022-03-23
excerpt: "Android fragment"
comments: true
categories : Android-ê¸°ì´ˆ
---

# Fragment
- TextViewë‚˜ Buttonì²˜ëŸ¼ ì•¡í‹°ë¹„í‹° í™”ë©´ì„ êµ¬ì„±í•˜ëŠ” ë·°
- í”„ë˜ê·¸ë¨¼íŠ¸ëŠ” **ì•¡í‹°ë¹„í‹°ì²˜ëŸ¼ ë™ì‘**í•œë‹¤.
    - ì¦‰, ì•¡í‹°ë¹„í‹°ì— ì‘ì„±í•  ìˆ˜ ìˆëŠ” ì½”ë“œë“¤ì€ ë‹¤ ê°€ëŠ¥í•¨

<img src="https://developer.android.com/images/guide/fragments/fragment-screen-sizes.png" width="700px"/>

<br/>

## Fragment êµ¬í˜„
### Fragment Class
```kotlin
import androidx.fragment.app.Fragment
class OneFragment : Fragment() {
    lateinit var binding: FragmentOneBinding

    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        binding = FragmentOneBinding.inflate(inflater, container, false)
        return binding.root
    }
}
```
- fragmentëŠ” activityì™€ ë‹¤ë¥´ê²Œ ì£¼ë¡œ onCreateViewë¥¼ ì´ìš©í•˜ì—¬ Viewë¥¼ ê·¸ë¦°ë‹¤.
- ìƒëª…ì£¼ê¸°ì—ì„œ ë‹¤ë£¨ì§€ë§Œ, onCreate() í›„ì— fragmentê°€ ì „í™˜ë  ë•Œë§ˆë‹¤ onCreatViewê°€ í˜¸ì¶œëœë‹¤.

### MainActivity
- xml
    ```xml
    <LinearLayout
        android:id=â€@+id/fragment_contentâ€
        android:layout_width=â€match_parentâ€
        android:layout_height=â€match_parentâ€
        android:orientation=â€verticalâ€>
    </LinearLayout>
    ```
- class
    ```kotlin
    val fragmentManager: FragmentManager = supportFragmentManager
    val transaction: FragmentTransaction = fragmentManager.beginTransaction()
    val fragment = OneFragment()
    transaction.add(R.id.fragment_content, fragment)
    transaction.commit()
    ```

- Fragmentë¥¼ ë™ì ìœ¼ë¡œ ì œì–´í•˜ë ¤ë©´ FragmentManagerë¡œ ë§Œë“  FragmentTransaction í´ë˜ìŠ¤ë¥¼ ì´ìš©í•´ì•¼ í•¨
    - add(): ìƒˆë¡œìš´ í”„ë˜ê·¸ë¨¼íŠ¸ë¥¼ í™”ë©´ì— ì¶”ê°€í•¨
    - replace(): ì¶”ê°€ëœ í”„ë˜ê·¸ë¨¼íŠ¸ë¥¼ ëŒ€ì²´í•¨
    - remove(): ì¶”ê°€ëœ í”„ë˜ê·¸ë¨¼íŠ¸ë¥¼ ì œê±°
    - commit(): í™”ë©´ì— ì ìš©
## Fragment ìƒëª…ì£¼ê¸°
![lifecycle](https://developer.android.com/images/guide/fragments/fragment-view-lifecycle.png)
- onCreateView()ëŠ” í”„ë˜ê·¸ë¨¼íŠ¸ì˜ í™”ë©´ì„ êµ¬ì„±í•  ë•Œ í˜¸ì¶œëœë‹¤.
    - ì´ í•¨ìˆ˜ê°€ ë°˜í™˜í•˜ëŠ” ë·°ë¥¼ í”„ë˜ê·¸ë¨¼íŠ¸ í™”ë©´ì— ì¶œë ¥í•¨
- onResume()ì´í›„ í”„ë˜ê·¸ë¨¼íŠ¸ê°€ ëŒ€ì²´ë  ë•Œ ë‘ ê°€ì§€ ë°©ì‹ìœ¼ë¡œ ì§„í–‰ëœë‹¤.
    - back stackì„ ì´ìš©í•  ë•Œ
        - onPause() â†’ onStop() â†’ onDestoryView() â†’ onDestory() â†’ onDetach() í•¨ìˆ˜ê¹Œì§€ í˜¸ì¶œ
        - ì´ ê³¼ì •ì„ í†µí•´ fragmentê°€ ì™„ë²½íˆ ì œê±°ê°€ ëœë‹¤.
    - back stackì„ ì´ìš©í•˜ì§€ ì•Šì„ ë•Œ
        - onPause() â†’ onStop() â†’ onDestoryView() í•¨ìˆ˜ê¹Œì§€ í˜¸ì¶œ
        - fragmentê°€ í™”ë©´ì—ì„œ ì‚´í•˜ì§„ í›„ back stackì— ì¶”ê°€ë  ë•Œ onDestroyViewë¥¼ í˜¸ì¶œí•˜ë©° ì™„ë²½íˆ ì œê±°ë˜ì§€ ì•ŠëŠ”ë‹¤.
        - ë’¤ë¡œê°€ê¸° ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ë‹¤ì‹œ onCreatView()ë¶€í„° í™œì„± ìƒíƒœê¹Œì§€ì˜ í•¨ìˆ˜ë“¤ì´ í˜¸ì¶œëœë‹¤.
        
- back stack
    - fragmentê°€ í™”ë©´ì— ë³´ì´ì§€ ì•ŠëŠ” ìˆœê°„ ì œê±°í•˜ì§€ ì•Šê³  ì €ì¥í–ˆë‹¤ê°€ ë‹¤ì‹œ ì´ìš©í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” ê¸°ëŠ¥
    - `transaction.addToBackStack(null)`ì„ í†µí•´ ì„¤ì • ê°€ëŠ¥í•¨

## ğŸ¯ Fragment ì „í™˜
- Fragmentë¥¼ ë™ì ìœ¼ë¡œ ì œì–´í•˜ë ¤ë©´ FragmentManagerë¡œ ë§Œë“  FragmentTransaction í´ë˜ìŠ¤ë¥¼ ì´ìš©í•´ì•¼ í•œë‹¤.
    - ì´ë•Œ, fragmentë¥¼ viewì— ì¶”ê°€í•˜ëŠ” ê²ƒì€ add, ëŒ€ì²´í•˜ëŠ” ê²ƒì€ replaceë¥¼ ì‚¬ìš©í•˜ì—¬ ì „í™˜í•œë‹¤.
- ê°„ë‹¨í•œ ì˜ˆì œë¥¼ í†µí•´ fragment to fragment ì „í™˜ì„ í™•ì¸í•´ë³´ì.
    ```kotlin
    val fragment = TwoFragment()
    supportFragmentManager
        .beginTransaction()
        .replace(R.id.fragment_content, fragment)
        .commit()
    ```
## ğŸ¯ Fragment ë¼ë¦¬ì˜ ë°ì´í„° ì „ë‹¬
1. Bundleì„ ì´ìš©í•´ì„œ ì „ë‹¬í•œë‹¤.
    ```kotlin
    val bundle = Bundle()
    bundle.putString("key", "value")

    val passBundleBFragment = PassBundleBFragment()
    passBundleBFragment.arguments = bundle
    parentFragmentManager.beginTransaction()
	.replace(R.id.fragment_container_bundle, PassBundleFragment())
	.commit()
    ```
    - ë°›ëŠ” ê³³ì—ì„œëŠ” activityì—ì„œ Extra dataë¥¼ ë°›ì•„ì˜¤ë“¯ ì´ìš©í•˜ë©´ ëœë‹¤.
2. Fragment Result APIë¥¼ ì´ìš©í•˜ì—¬ ì „ë‹¬í•œë‹¤.
    - ì „ì†¡ fragment
        ```
        val result = "result"
        setFragmentResult("requestKey", bundleOf("bundleKey" to result))
        parentFragmentManager
            .beginTransaction()
            .replace(R.id.fragment_container_bundle, PassBundleFragment())
            .commit()
       ```
    - ìˆ˜ì‹  fragment
        ```
        setFragmentResultListener("requestKey") { requestKey, bundle ->
        val result = bundle.getString("bundleKey")
        }
       ```
## ğŸ¯ Fragment ê°„ ë’¤ë¡œê°€ê¸°ëŠ” ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œ?
- back stackì„ ì´ìš©í•œë‹¤.
    - ì´ëŠ” í”„ë˜ê·¸ë¨¼íŠ¸ê°€ í™”ë©´ì—ì„œ ì‚¬ë¼ì§ˆ ë•Œ ìŠ¤íƒì— í”„ë˜ê·¸ë¨¼íŠ¸ë¥¼ ì €ì¥í•˜ê³  ìˆë‹¤ê°€
        - ë’¤ë¡œê°€ê¸°ë¥¼ ëˆŒë €ì„ ë•Œ ë‹¤ì‹œ êº¼ë‚´ì˜¤ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.
- ì‚¬ìš©ë°©ë²•ì€ `transaction.addToBackStack(null)`ì„ í†µí•´ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.
```kotlin
val fragment = TwoFragment()
supportFragmentManager
    .beginTransaction()
    .replace(R.id.fragment_content, fragment)
    .addToBackStack(null)
    .commit()
```